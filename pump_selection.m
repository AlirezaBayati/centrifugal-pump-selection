%% Pump_selection ||  AlirezaÂ Bayati

clc; clear; close all

%% Raw data from pumpiran catalogue curves _________________________________
% _________________________________________________________________________


%% Raw curve data for pump selection 
data_40160 = [14.052603880951779, 38.97004483690849
16.714610887351647, 38.53679413250401
19.65967755390328, 38.10836010649065
23.51679790820208, 36.98901221838407
27.510212643184033, 35.23976494003907
30.94861246085109, 32.830887804747796
34.62721211998662, 29.577828301058357
37.25177495079102, 27.24962845628354
39.41123559698748, 24.641247027597977
];
data_32160 = [3.017102858382947, 39.11554145341729
3.752730482212094, 39.11554145341729
4.564423580033716, 39.11554145341729
5.838193735801033, 39.40816637131045
7.679723021001228, 39.11554145341729
10.215636389691817, 38.97004483690849
12.9220464873141, 38.53679413250401
15.807798193715213, 36.98901221838407
19.557055595215246, 34.847985740214774
24.75017916523709, 30.58667377270941
];
data_40125 = [21.426387054714684, 22.44924096618746
23.965590348897653, 21.87119817517221
25.776629865554355, 21.22878062114134
27.2639126828828, 20.452228712025363
29.161480945911624, 19.70408318565522
30.67291222256794, 18.842344604647124
32.627659405550645, 17.751697510013724
34.51283409740254, 16.786620655038664
35.89878716071308, 15.933276933942082
];
data_32125 = [3.005554548170653, 25.29250056624032
4.421458372770836, 25.386931385369106
6.0822385554184795, 25.29250056624032
8.274364902244336, 24.73324635898386
11.008289767998583, 23.739866596767996
14.084552169169084, 22.199660820651278
17.137140655608388, 20.300360906474648
19.60888922898169, 18.085565509364514
22.064376926623567, 15.992764622331686
23.741383269777014, 14.03712334691664
];


%% pump 40160 data (impeller,efficiency,power)-----------------------------
impellar_data_40160_130 = [0.17552759898881032, 23.16919750548353
2.9177681925699166, 23.17205847636885
6.604340233536517, 23.1289563084408
10.021465098500256, 23.03862467032392
12.361926887341841, 22.57158289858562
15.02044890665574, 21.541492676383548
17.456166955629932, 20.182531505855614
19.85030712444285, 18.26014667556747
21.976969966059187, 15.961895932574897
];
impellar_data_40160_140 = [0.2432059758333942, 26.87818830191216
4.289416127433583, 26.83546134328055
8.470771977493694, 26.745927024918586
12.47399721407097, 26.374516722609332
16.300498872027045, 25.486490120270215
19.277643935757908, 23.799455321171344
22.43742212452883, 21.64312749455556
24.925411518612723, 19.063563581560338
27.007963817316835, 16.62442174775617
];
impellar_data_40160_150 = [0.17517584027340183, 30.72788258450417
4.8507526854823695, 30.68581224214132
10.021394746757172, 30.550361686128046
14.835494174093984, 29.89810722543669
19.787553369613985, 28.729564772849855
23.48678872433529, 26.573799760178723
26.603863405055623, 24.041840526668782
29.40738036686088, 21.321760732158406
31.80743008209266, 18.41346657432349
];
impellar_data_40160_160 = [0.013015072470112354, 35.28170401301976
4.59896379699301, 35.192591805116294
9.994379677413804, 35.05737575491328
14.580891215881358, 34.87436742057679
18.272528582349835, 33.98620011475151
22.32521109431354, 32.863667702140106
25.435813414670363, 31.41151392260996
28.551199653556733, 29.16124306839909
31.219008102957414, 26.58186676005209
33.571570391609065, 24.096058270003738
35.292796137845635, 21.93822960620221
36.78784103007458, 20.014906752672974
];
impellar_data_40160_169 = [0.07872360050840843, 39.31933125196399
4.799818023491229, 39.18341168433017
9.654932517044662, 39.18847700983205
13.926479301735498, 39.05208843057768
18.515523502953986, 38.446547527292566
23.73618565355987, 37.46607873454411
27.56775263701783, 35.732986994307765
30.547430363499632, 33.62341962626027
33.665912079081615, 30.856720076667767
36.15333865922084, 28.371052290105574
38.55226274656331, 25.65055038513671
40.815196914528876, 23.117700029547738
];

% efficiency data ---------------------------------------------------------
efficiency_data_40160_45 = [8.486101864525228, 23.32554552559432
8.865891883174614, 27.117987354805628
9.493633984063253, 32.048806811368266
10.283452080171692, 36.113980424345925
10.823457290421825, 39.257373951230406
];

efficiency_data_40160_50 = [10.136448594266247, 23.225186183739883
10.725206859335655, 26.693724129660797
11.21831981838557, 29.295375696250687
11.352483759319526, 31.678692971537973
11.992786284636793, 35.147479024608096
12.887553704860006, 38.99655131062602
];

efficiency_data_40160_55_left = [12.408117652410157, 22.802907815788707
12.591965049972918, 25.403070739483358
13.080891200879956, 28.492066773904085
13.470915639434155, 31.093222126195567
14.065721516265492, 33.85781806302749
14.608517931944212, 36.67631527802473
15.259520078071054, 38.89966546886048
];

efficiency_data_40160_55_right = [21.636959281481698, 16.565742191861258
24.82758620689655, 17.176768073572035
29.458196012918116, 18.173786652662393
32.846161162133896, 19.81464328394622
36.134294197187295, 21.075958003729877
40.60050200346523, 23.209369352977905
];

efficiency_data_40160_60 = [18.458520619771658, 38.53600241490959
18.006717501064795, 37.125885432388735
17.660794108282232, 35.39136835227907
17.263791656156577, 33.60245377970566
16.770213496201894, 31.054951598430307
16.63279314893459, 29.050680020344785
16.59753092035347, 27.155203427186756
16.612417349305918, 25.422423097121545
17.294587956051956, 24.017764471883257
18.540954220095852, 22.94073133717348
20.40445600439977, 22.029123644197806
22.779678783944163, 21.553192105230508
25.509663773461636, 21.782939325396658
28.906467739867928, 22.39495763570427
32.55494539575158, 23.71215849084691
38.04924720155812, 26.175428294966316
];

efficiency_data_40160_64 = [21.71232182805348, 37.79354177090613
21.47041735757616, 35.9512221344658
21.17882943047004, 33.89205684961812
21.20301987751777, 31.076288813262153
21.58011173091953, 29.18279707729778
22.469854981371288, 27.61668272471271
23.96882533670208, 27.136533364208887
26.341256910817886, 26.98549813712882
29.068915895811543, 27.485992283867656
31.22958801807875, 27.983757251965216
34.824660610095485, 29.5173075412168
];

efficiency_data_40160_66 = [23.882763169320725, 37.15416964739839
23.736038803958138, 36.23288577560362
23.954311068473437, 34.82599418602247
24.43263063875186, 33.149596205614664
25.372987747641947, 31.69202873080788
26.926293568649182, 30.887231165566032
28.839013608677135, 30.24661850631226
31.2081887764596, 30.474628976433955
32.84737068448627, 31.673854882128428
];

efficiency_data_40160_675 = [28.851480992924813, 34.79541497988264
];

% Power data 
Power_data_40160_130 = [7.068062827225131, 1.0179640718562872
9.18848167539267, 1.137724550898204
11.921465968586386, 1.2874251497005984
14.795811518324605, 1.447105788423154
17.481675392670155, 1.55688622754491
19.743455497382197, 1.6866267465069864
21.81675392670157, 1.7365269461077846
22.994764397905758, 1.756487025948104
];
Power_data_40160_140 = [7.115183246073298, 1.2774451097804391
9.565445026178008, 1.407185628742515
12.722513089005233, 1.6167664670658684
15.408376963350786, 1.7864271457085832
17.670157068062828, 1.9361277445109781
19.8848167539267, 2.0958083832335332
21.722513089005233, 2.2155688622754495
24.031413612565444, 2.295409181636727
27.42408376963351, 2.3253493013972055
];
Power_data_40160_150 = [7.256544502617801, 1.5169660678642716
9.565445026178008, 1.6566866267465068
12.157068062827225, 1.8363273453093814
14.890052356020941, 2.0159680638722555
18.141361256544503, 2.295409181636727
20.544502617801047, 2.49500998003992
23.27748691099476, 2.624750499001996
26.29319371727749, 2.7744510978043913
29.308900523560208, 2.8542914171656686
32.324607329842934, 2.9341317365269464
];
Power_data_40160_160 = [7.115183246073298, 1.9161676646706587
9.612565445026178, 2.0558882235528944
12.581151832460733, 2.255489021956088
15.219895287958114, 2.455089820359282
17.858638743455497, 2.694610778443114
20.68586387434555, 2.9341317365269464
23.418848167539267, 3.163672654690619
26.05759162303665, 3.3333333333333335
28.884816753926703, 3.4930139720558886
31.806282722513085, 3.5828343313373257
34.16230366492147, 3.6726546906187627
36.70680628272251, 3.7325349301397206
];
Power_data_40160_169 = [6.973821989528795, 2.1756487025948106
10.130890052356019, 2.415169660678643
13.900523560209425, 2.694610778443114
17.76439790575916, 3.093812375249501
21.298429319371724, 3.44311377245509
25.77486910994764, 3.852295409181637
30.157068062827225, 4.131736526946108
34.25654450261781, 4.3213572854291415
38.30890052356021, 4.471057884231537
41.84293193717278, 4.590818363273453
];




%% pump 32160 data (impeller,efficiency,power)-----------------------------
impellar_data_32160_130 = [0, 23.33333333333333
2.029974659442508, 23.33333333333333
3.948576868691112, 23.16091954022988
5.910090021980484, 22.758620689655164
7.871533173729822, 22.413793103448267
9.620241645316199, 21.724137931034477
11.454842006524142, 20.51724137931034
13.24709143601159, 19.08045977011494
14.996919932238509, 17.471264367816083
16.576224676942893, 15.862068965517231
17.942374732244108, 14.25287356321838
19.35157573466616, 12.298850574712638
];

impellar_data_32160_140 = [0.021560474330435397, 27.241379310344822
2.110686435101572, 27.068965517241374
4.0290086381900405, 27.12643678160919
5.905259915718147, 26.724137931034477
7.994525879569349, 26.436781609195396
9.870917160177523, 25.91954022988505
11.790219384826468, 25.172413793103445
13.625029750654512, 23.793103448275858
15.374578240721295, 22.413793103448267
16.996373920226244, 20.91954022988505
18.575818668010694, 19.195402298850567
20.240735296176513, 17.298850574712638
21.692777241099304, 15.172413793103438
];

impellar_data_32160_150 = [0.10192224228933044, 31.264367816091948
2.5318857014854323, 31.264367816091948
4.706273538017836, 31.0919540229885
7.093956067033475, 30.80459770114942
9.737774231033082, 30.229885057471257
12.509975219454827, 29.252873563218387
14.941548714071708, 27.931034482758616
17.20322847102636, 26.0919540229885
19.380136362999984, 23.850574712643674
21.471712377672308, 21.66666666666666
23.2650818318003, 19.310344827586203
24.88743752362552, 17.356321839080458
];

impellar_data_32160_160 = [0.01106024332535327, 35.86206896551724
2.69687933134529, 35.80459770114942
5.169543729962059, 35.7471264367816
7.940974701443431, 35.40229885057471
10.627563806403742, 34.712643678160916
13.35685385078472, 33.9655172413793
15.958951096924132, 32.643678160919535
18.263191790219384, 30.862068965517235
20.823568118498606, 28.793103448275858
22.91521413471096, 26.55172413793103
25.177383902445854, 24.3103448275862
26.97068335503381, 22.011494252873558
28.337253419575227, 20.057471264367813
];

impellar_data_32160_169 = [0, 39.88505747126436
3.203620479650552, 39.77011494252873
6.656936452601957, 39.59770114942528
10.451789939378667, 39.02298850574712
13.010486230697076, 38.33333333333333
16.294678482926624, 37.01149425287356
19.750444509779214, 34.82758620689655
23.121228667030675, 32.41379310344827
26.322329091240007, 29.3103448275862
29.01206826550184, 26.034482758620683
30.806767748890472, 22.58620689655172
];

% efficiency data ---------------------------------------------------------
efficiency_data_32160_45_left = [4.122681485336208, 23.216555774448945
4.499219417908783, 27.184886443891017
4.826599264022599, 31.153402966211942
5.302289707467568, 34.922871055272644
5.8726721926922645, 39.55209456194476
];

efficiency_data_32160_45_right = [18.714176857599526, 13.501654090621862
20.479686280340484, 14.487417760101103
22.196316395940975, 15.407203657584652
24.598093149462883, 17.05218748838419
26.75240679478125, 19.09508233282534
28.71176077017433, 20.741738839534623
30.66944206965766, 22.78537709549121
];

efficiency_data_32160_50_left = [6.53310039772516, 22.810467234137455
6.91047466825261, 26.580307028955875
7.384492435787831, 30.746756867263873
8.003754228152992, 35.44195814593168
8.577203285878898, 39.343381778983755
];

efficiency_data_32160_50_right = [17.922908225848417, 14.629409359550976
19.93392930156488, 15.680407389510457
21.649165520573913, 16.93101141136676
23.462160353863883, 18.313570977214432
25.519272943537896, 20.092183027915098
27.230885031409137, 22.202914173140538
29.38101698695313, 25.238263390699924
];

efficiency_data_32160_55_left = [8.598855146266214, 22.53800691372709
8.926792551016614, 26.374196186298924
9.352767349366239, 30.276177377987583
9.78041482362562, 33.78117682042894
9.96784745195703, 35.963833029773625
10.4468832472215, 38.939337620339735
];

efficiency_data_32160_55_right = [15.9482213879493, 16.6217522209419
18.695498643273986, 17.93461695721667
20.558487900977585, 19.118499795561835
23.006356168457046, 21.491097647102553
25.208712782961012, 23.79846113816303
27.65267813998439, 27.097349737947443
];

efficiency_data_32160_58_left = [10.717949671040405, 21.27290636731963
10.850369847228933, 24.84518455190871
11.131379400066905, 28.152250678363004
11.608742519421625, 31.52473701817641
12.085826859458052, 34.963386982864364
12.710385458870757, 38.40147938891573
];

efficiency_data_32160_58_right = [13.923818904954835, 18.746608184960785
16.77024867115192, 19.860610340854176
19.760807344905775, 21.768018436605583
22.209233171021822, 24.008289038397205
24.068040738951044, 26.184626249860607
26.317603984685725, 28.95494926216407
];

efficiency_data_32160_60 = [15.271066423818905, 37.333197041222164
14.691763000408876, 34.821209530535626
14.359922685202395, 31.91131100620748
14.174441512099023, 29.26550942274096
14.236144667880904, 26.287960450507374
14.883841950711815, 24.234471991971155
15.822584841839202, 23.106159164405458
17.346485522060735, 23.100397725160764
19.79937181726945, 24.282050328959592
21.70677991302085, 26.59052893729324
23.123443482139535, 28.702375199791845
24.39319035051853, 30.682451771177934
];

efficiency_data_32160_62 = [16.207300301081663, 36.80035683752741
15.821283871687172, 35.08158941382001
15.879084117012972, 33.03033118983013
16.083801063078468, 31.11084265695275
16.68066758354087, 29.454521800542686
17.71744786826748, 28.392000892093815
19.09582574434078, 27.923651637363864
20.961324015909007, 28.512061851838087
22.232186001561164, 30.227483923725977
23.158662602683716, 32.01037059064045
];

efficiency_data_32160_636 = [19.804203992119838, 34.80188083113407
];
% power data 
Power_data_32160_130 = [4.063807531380754, 0.6567411083540118
6.016387726638774, 0.8221670802315963
8.060495118549513, 0.9379652605459059
9.982566248256624, 1.053763440860215
12.026673640167365, 1.153019023986766
13.94874476987448, 1.2440033085194377
15.962343096234314, 1.3101736972704714
17.945432357043238, 1.368072787427626
19.531903765690377, 1.4094292803970223
];
Power_data_32160_140 = [3.972280334728034, 0.7808105872622
5.985878661087867, 0.9214226633581468
8.213040446304046, 1.119933829611249
10.714783821478383, 1.3019023986765923
13.49110878661088, 1.4921422663358146
16.11488842398884, 1.6492969396195205
19.04375871687587, 1.7733664185277092
21.08786610878661, 1.8395368072787428
22.61331938633194, 1.864350703060381
];
Power_data_32160_150 = [3.9112622036262206, 0.9545078577336641
6.5655509065550905, 1.1695616211745246
10.409693165969317, 1.4838709677419355
13.826708507670851, 1.7485525227460714
16.60303347280335, 1.9966914805624487
19.34884937238494, 2.1373035566583956
22.796373779637378, 2.344086021505377
25.481171548117157, 2.385442514474773
];
Power_data_32160_160 = [4.063807531380754, 1.119933829611249
6.870641562064158, 1.425971877584781
10.043584379358439, 1.7568238213399505
13.643654114365413, 2.0794044665012406
17.640341701534172, 2.4764267990074442
20.66073919107392, 2.7411083540115797
24.56589958158996, 2.972704714640199
28.715132496513252, 3.1629445822994215
];
Power_data_32160_169 = [4.033298465829847, 1.3928866832092641
6.474023709902372, 1.6492969396195205
10.043584379358439, 2.021505376344086
13.94874476987448, 2.4102564102564106
17.579323570432358, 2.774193548387097
21.240411436541144, 3.105045492142267
24.932008368200837, 3.4110835401157984
27.982914923291492, 3.634408602150538
31.125348675034868, 3.83291976840364
];


%% pump 40125 data (impeller,efficiency,power) ----------------------------
impellar_data_40125_110 = [0, 14.777495315854129
3.9435932672382763, 14.780985159633211
8.027548051271234, 14.585864116340534
11.980633693588613, 14.23164497276371
16.946611594346763, 13.282136032559468
20.992527081187724, 11.974103808117533
24.953360176694666, 10.149303272077528
29.048831445198594, 7.7681828616098585
];

impellar_data_40125_115 = [0.026034234591951755, 16.72506080083384
3.9335425171545206, 16.688766425531387
8.017916082440967, 16.41415449615962
12.016369693886414, 15.781756027347967
15.971130461217756, 15.10957333945478
19.92756635356305, 14.11942710724523
23.403380960653173, 12.691654465138786
26.396480376220666, 11.223709843530916
29.127003945850035, 9.596550793512925
32.38791397302428, 7.294184524326543
];

impellar_data_40125_120 = [0, 18.076367088136394
4.497152287476268, 18.040615577421796
8.493093211400774, 17.885162425084687
12.929731607747764, 17.41213348885111
17.32518984750158, 16.42237501706146
21.238351676986262, 15.312953679691283
24.758277909443976, 13.845474370587286
27.751796106264965, 12.298038862900324
30.74636125621967, 10.551876140015633
33.69786173394051, 8.646692868930778
];

impellar_data_40125_125 = [0, 20.14313012619275
4.354766661289723, 20.067516844312642
8.57063754017198, 19.83276668610639
13.359331376952762, 19.20106618605055
17.974719571664327, 18.132010708391757
22.371643545805366, 16.864034135325284
26.772127160601055, 14.92038503058654
30.95519350795994, 12.579087615242393
34.127880284399, 10.356134680051124
36.772065118933874, 8.450679976672333
];

impellar_data_40125_130 = [0.042296906602474316, 21.97149805809582
4.783528867987741, 22.015431313670263
9.526854735640457, 21.66191013884925
14.183423086945195, 21.109584196746535
18.84271351639761, 20.04056749512973
23.54758130560484, 18.65362602523855
28.168413656611776, 16.551189028551576
32.26451309699594, 14.050832288965271
35.305074387958946, 11.907253911727114
38.43574344529786, 9.326553213137945
];

impellar_data_40125_135 = [0.07635778188631459, 23.839572656996438
4.686511210929259, 23.764153255326278
8.85785168319043, 23.648600650196673
13.074978905833158, 23.17537783375315
17.601515677929296, 22.3049720192081
21.822621322480174, 21.076585785013215
25.342128773684404, 19.688597361988315
28.246167376009723, 18.459047846533732
31.503727153156056, 16.79260866598007
34.323102145400846, 14.966799952848334
37.05530084004417, 13.02167735851398
39.611890595724084, 11.076399660011663
];

impellar_data_40125_139 = [0.06881971932349762, 25.27040860642007
5.073674479780621, 25.27482907520691
9.992190505143252, 25.00095389063295
14.956702671514192, 24.329663051705527
19.30742111402017, 23.498847576032063
23.969224230993532, 21.952885557940714
28.589219019493488, 20.00943033341192
33.38754482510454, 17.549439453536998
36.86859419786328, 15.128030735441925
40.52504311895869, 12.746522564554358
42.46658280701319, 10.880192887543274
];

% efficiency data ---------------------------------------------------------
efficiency_data_40125_50_left = [8.39037284362827, 14.589336136358952
8.64895195696531, 17.01137698633525
9.16100908922278, 19.341752715431067
9.775273604155073, 22.037655351511777
10.79549248747913, 24.77884952286733
];

efficiency_data_40125_50_right = [30.443238731218692, 6.75158185453121
32.67659061398627, 7.297759640553185
34.96123168243368, 8.11810836991694
37.65145613058801, 8.800933654856859
39.88545724355407, 9.667037655351507
42.42413281394917, 10.669943733382794
];

efficiency_data_40125_55_left = [10.216657391949544, 14.541777448010055
10.57698015210536, 17.100826480347905
10.987293637544054, 19.29419402708217
11.701910591726952, 21.441548671654402
13.026989426822485, 24.410952410395925
];

efficiency_data_40125_55_right = [28.821925431274344, 7.804416826397905
31.817195325542563, 8.806859168573133
34.76182526432944, 9.855056781879263
37.90966425524021, 11.04015952513448
40.44889630866258, 12.317288072713776
];

efficiency_data_40125_60_left = [12.803283249860879, 14.173519652095052
13.264607679465776, 16.5039469073971
13.828324986087921, 19.291308559533377
14.441383787794472, 21.393062511593392
15.866815062140606, 23.813918258826437
];

efficiency_data_40125_60_right = [27.04859951771471, 8.948813866732618
30.34872936375441, 10.179465776293824
33.54748655166017, 11.455924483192149
36.74652198107957, 12.869494424864481
38.625486922648854, 13.781662853727404
];

efficiency_data_40125_65_left = [16.302170283806344, 13.347296935221252
16.814412910406233, 15.769080154166407
17.27592283435355, 18.19091489931779
17.99053978853645, 20.33826954389002
19.46735299573363, 23.078999979389515
];

efficiency_data_40125_65_right = [23.957429048414024, 10.688699272449966
27.00361713967724, 11.782497578268305
29.643943609719898, 12.876708093736472
32.08171025783714, 14.153939693728226
35.433593025412726, 15.887281271254555
];

efficiency_data_40125_68 = [22.712483769245033, 22.20733114862219
22.70877388239658, 20.379181351635438
22.908180300500835, 18.642232939673114
23.564273789649416, 16.950524536779405
24.77953997403079, 15.806694284713199
26.959562233351882, 15.07321873905068
29.445557410498978, 15.116397699870149
31.83194212576516, 16.073754611595454
33.50834724540901, 17.168944124981962
];

efficiency_data_40125_70 = [29.40335744759785, 19.3211937591459
];
% power data
Power_data_40125_110 = [7.939765458422174, 0.6528985507246379
12.257462686567164, 0.794202898550725
16.0954157782516, 0.8992753623188408
19.933368869936032, 0.982608695652174
23.97121535181237, 1.0804347826086957
27.609275053304906, 1.1311594202898554
30.927505330490405, 1.1347826086956525
];
Power_data_40125_115 = [8.059701492537313, 0.8195652173913046
12.577292110874199, 1.011594202898551
17.134861407249467, 1.1710144927536235
22.252132196162044, 1.3123188405797102
26.769722814498934, 1.4210144927536232
31.687100213219615, 1.4898550724637682
34.88539445628998, 1.5079710144927538
];
Power_data_40125_120 = [8.019722814498932, 0.8231884057971017
13.33688699360341, 1.0478260869565221
17.734541577825155, 1.1891304347826088
21.892324093816633, 1.3050724637681161
26.409914712153515, 1.4210144927536232
31.367270788912577, 1.4934782608695654
34.72547974413646, 1.5079710144927538];
Power_data_40125_125 = [8.019722814498932, 0.9318840579710148
11.257995735607675, 1.0768115942028988
15.455756929637525, 1.2579710144927538
19.45362473347548, 1.3992753623188408
22.571961620469082, 1.4898550724637682
25.210554371002132, 1.551449275362319
28.688699360341147, 1.6384057971014494
31.966950959488273, 1.6746376811594204
36.64445628997868, 1.7108695652173913];
Power_data_40125_130 = [7.939765458422174, 1.0333333333333337
13.136993603411513, 1.2869565217391306
17.6545842217484, 1.478985507246377
21.972281449893387, 1.627536231884058
26.769722814498934, 1.7652173913043478
31.727078891257996, 1.877536231884058
36.04477611940298, 1.9391304347826088
38.923240938166316, 1.953623188405797];
Power_data_40125_135 = [7.899786780383796, 1.1746376811594206
10.938166311300638, 1.341304347826087
15.135927505330487, 1.5731884057971017
19.693496801705756, 1.772463768115942
24.171108742004265, 1.942753623188406
28.768656716417915, 2.091304347826087
33.486140724946694, 2.1891304347826086
37.603944562899784, 2.232608695652174
40.84221748400852, 2.243478260869565];
Power_data_40125_139 = [7.899786780383796, 1.2760869565217392
12.337420042643922, 1.544202898550725
16.49520255863539, 1.7760869565217392
20.852878464818758, 1.9681159420289855
25.250533049040506, 2.134782608695652
29.928038379530918, 2.2905797101449274
35.085287846481876, 2.4065217391304348
39.68283582089552, 2.47536231884058
42.921108742004265, 2.486231884057971];


%% pump 32125 data (impeller,efficiency,power)-----------------------------
impellar_data_32125_110 = [0.019989982469321266, 15.920000000000002
2.025499624342599, 15.920000000000002
4.0313999499123465, 15.723636363636366
5.392997746055596, 15.363636363636365
6.969666917104932, 14.905454545454546
8.081096919609315, 14.283636363636365
9.37204608064112, 13.432727272727274
10.7706937139995, 12.450909090909093
12.098041572752315, 11.305454545454545
13.031254695717507, 10.258181818181818
14.107913849236162, 9.112727272727277
14.969631855747554, 8
];

impellar_data_32125_115 = [0.05306786877034808, 17.294545454545457
2.058382168795392, 17.392727272727274
3.992722263961933, 17.163636363636364
5.640691209616829, 16.869090909090907
7.504512897570748, 16.083636363636366
9.332652141247184, 15.232727272727274
11.125434510393188, 14.152727272727274
12.847047332832457, 12.843636363636366
14.246541447533183, 11.436363636363637
15.53807663410969, 10.290909090909093
16.97370899073378, 8.720000000000002
];

impellar_data_32125_120 = [0.1933233158026546, 18.8
1.9481442524417734, 18.8
4.02580015026296, 18.53818181818182
5.996148259454045, 18.21090909090909
7.931204608064111, 17.621818181818185
9.866651640370648, 16.836363636363636
11.90999248685199, 15.821818181818182
13.882554470323065, 14.381818181818183
15.497054845980461, 12.90909090909091
16.68128224392687, 11.69818181818182
18.404783370899068, 9.440000000000001
];

impellar_data_32125_125 = [0.15432006010518418, 20.403636363636366
2.0880090157776108, 20.501818181818184
3.9864713248184316, 20.305454545454545
5.706000500876533, 20.043636363636367
7.85580265464563, 19.520000000000003
10.078011520160281, 18.603636363636365
12.085604808414725, 17.55636363636364
14.093719008264461, 16.24727272727273
15.815201602804905, 15.003636363636366
17.178948159278736, 13.563636363636366
18.542564487853742, 12.189090909090911
20.086481342349106, 10.192727272727275
];

impellar_data_32125_130 = [0.04369146005509661, 22.007272727272728
2.013453543701477, 21.974545454545456
3.947728524918608, 21.77818181818182
6.598647633358378, 21.385454545454547
9.536719258702728, 20.665454545454548
11.508174305033808, 19.78181818181818
13.981983471074379, 18.407272727272726
16.31319308790383, 16.705454545454547
18.214325068870522, 15.167272727272728
19.61388429752066, 13.72727272727273
20.79824192336589, 12.450909090909093
21.87535687453043, 11.076363636363638
];

impellar_data_32125_139 = [0.03672426746806945, 25.509090909090908
2.1137941397445523, 25.541818181818183
4.406130728775357, 25.37818181818182
6.913929376408714, 24.92
9.672872526922113, 24.232727272727274
12.074144753318304, 23.316363636363636
13.831049336338591, 22.26909090909091
15.910593538692709, 21.05818181818182
17.596328575006257, 19.78181818181818
19.49752566992236, 18.21090909090909
21.004457801152018, 16.803636363636365
22.403756574004507, 15.494545454545456
23.588244427748556, 14.152727272727274
24.88036563986977, 12.712727272727275
];

% efficiency data ---------------------------------------------------------
efficiency_data_32125_50_left = [5.393914557934639, 15.36280019290307
5.647806976994062, 16.79726437465174
5.9014395266378665, 18.101294099714895
6.29942953665783, 19.86166451358193
6.805265354159537, 21.7523344519379
7.311490975784671, 23.838656075322152
7.564278949827712, 24.718773816157384
];

efficiency_data_32125_50_right = [14.668329164594795, 8.405516228095383
16.42712536950183, 9.18591907566448
18.1140027136364, 9.868586035517158
19.87286388589734, 10.68159749725763
21.703449016869026, 11.494519004200395
22.996039490156203, 12.27550655795463
24.611192875580024, 12.958263472605019
];

efficiency_data_32125_55_left = [6.970802171908617, 14.839083360611296
7.368857149282486, 16.632062388649707
7.766782191948548, 18.359824188345357
8.09311321061167, 20.152893171181482
8.59888406075947, 22.01095449536608
9.32073632999418, 24.32526655355684
];

efficiency_data_32125_55_right = [13.702719383509788, 9.743683798891059
15.532849743004142, 10.328345006634166
17.040677059777465, 11.141671310166643
18.656220249324715, 12.020079909845307
20.271698471518064, 12.865879895352586
21.636142838223797, 13.711994722651868
23.14403512235102, 14.557929640355724
];

efficiency_data_32125_59_left = [8.260664016331795, 14.250509119167619
8.478889358097558, 15.782844120829285
8.76896859328188, 17.38030639603599
9.13070681982304, 18.94507010227361
9.600160919138137, 20.57491610465741
10.24905484993791, 22.269754448389687
10.79010297325594, 23.834293267633015
];

efficiency_data_32125_59_right = [12.700922786299888, 10.918853276228695
14.208490233657592, 11.601745123075656
15.788171443849468, 12.480198700153176
17.403779600750628, 13.391215914003215
19.091306618424245, 14.399969015569678
21.712674381123488, 16.12494221653619
];

efficiency_data_32125_60 = [12.043972903615934, 23.180546775245443
11.683144220029437, 22.07230366740713
11.250461643024384, 20.898933286023777
10.781722184602241, 19.62778203952514
10.312333052641051, 18.030544651312717
9.807016973970583, 16.400743626327774
9.69650750497875, 14.933490920812295
9.80155971624259, 13.661620035931946
10.516850282732928, 12.682462062813437
11.52027106379045, 12.322507939760273
13.385418827039416, 12.483212185876601
15.072491073235703, 13.26370498824341
16.473187223420236, 14.305426523172109
18.052998368319923, 15.249097328592384
20.63876402107941, 17.104549963643272
];

efficiency_data_32125_62 = [13.261980854620553, 22.52684526025672
12.685655458132292, 21.255828945954658
12.324501937776272, 19.984542767259455
11.963283450066342, 18.68064797439287
11.817431740550376, 17.47430915964728
11.743303989745158, 16.267880390103976
12.243942418934488, 15.54986119474964
13.606372797669177, 15.385108982736178
15.077753428901978, 15.905002736125098
16.549588831612116, 16.653156788713673
17.9858221243825, 17.53179027538662
19.135354484371607, 18.50860942376456
];

efficiency_data_32125_63 = [14.69503074704961, 21.807656652532103
14.226875994812612, 20.82998293357588
13.865397637687064, 19.39565368402378
14.257540585855608, 18.221248822466713
15.871264689493533, 18.186616225346768
17.127733314009713, 18.837214299814345
17.91806117425994, 19.521005694638447
];

efficiency_data_32125_635 = [16.4141968660748, 20.69680485556008
];

% Powe data
Power_data_32125_110 = [4.014909478168265, 0.3924050632911389
5.999290024849131, 0.47257383966244704
7.937522186723465, 0.5400843881856536
9.968051118210862, 0.6075949367088604
11.952431664891728, 0.6371308016877635
13.590699325523607, 0.6624472573839659
14.790557330493431, 0.6751054852320673
];
Power_data_32125_115 = [3.9687610933617337, 0.4599156118143457
5.953141640042599, 0.5316455696202529
7.960596379126731, 0.6118143459915608
9.991125310614128, 0.6751054852320673
12.021654242101526, 0.7341772151898733
14.029108981185658, 0.7890295358649786
16.61341853035144, 0.8481012658227847
];
Power_data_32125_120 = [3.9687610933617337, 0.5232067510548519
5.999290024849131, 0.6118143459915608
7.960596379126731, 0.6877637130801684
9.968051118210862, 0.7637130801687761
11.975505857294994, 0.8354430379746833
14.006034788782394, 0.8902953586497888
15.87504437344693, 0.9409282700421939
18.27476038338658, 0.9789029535864975
];
Power_data_32125_125 = [4.084132055378063, 0.6033755274261601
6.022364217252395, 0.6877637130801684
8.029818956336529, 0.7763713080168773
9.991125310614128, 0.852320675105485
11.929357472488464, 0.9282700421940926
14.213702520411786, 1.0084388185654007
16.221157259495918, 1.0590717299578056
18.06709265175719, 1.1054852320675104
19.843805466808664, 1.1434599156118141
];
Power_data_32125_130 = [3.9226127085552007, 0.7552742616033754
6.045438409655663, 0.852320675105485
8.445154419595314, 0.9451476793248943
10.406460773872915, 1.0253164556962024
12.137025204117856, 1.0759493670886076
14.190628328008518, 1.1476793248945145
16.08271210507632, 1.210970464135021
18.020944266950657, 1.2742616033755274
19.95917642882499, 1.3248945147679323
21.38977635782748, 1.3628691983122363
];
Power_data_32125_139 = [3.9456869009584667, 0.8438818565400841
5.999290024849131, 0.9578059071729956
8.006744763933263, 1.063291139240506
9.944976925807598, 1.1772151898734176
11.998580049698262, 1.2742616033755274
13.821441249556266, 1.371308016877637
16.036563720269793, 1.4514767932489452
18.482428115015974, 1.5569620253164556
20.859069932552362, 1.641350210970464
22.635782747603834, 1.7046413502109705
24.64323748668797, 1.7679324894514767
];




%% data structure control _________________________________________________

Q_40160 = data_40160(:,1);   
H_40160 = data_40160(:,2);   

Q_32160 = data_32160(:,1);   
H_32160 = data_32160(:,2);   

Q_32125 = data_32125(:,1);   
H_32125 = data_32125(:,2);   

Q_40125 = data_40125(:,1);   
H_40125 = data_40125(:,2);   


% 40160 -------------------------------------------------------------------
pump(1).name = '40160';
pump(1).Q = Q_40160;
pump(1).H = H_40160;
pump(1).imp(1).D = 130;
pump(1).imp(1).Q = impellar_data_40160_130(:,1); 
pump(1).imp(1).H = impellar_data_40160_130(:,2);  

pump(1).imp(2).D = 140;
pump(1).imp(2).Q = impellar_data_40160_140(:,1); 
pump(1).imp(2).H = impellar_data_40160_140(:,2);

pump(1).imp(3).D = 150;
pump(1).imp(3).Q = impellar_data_40160_150(:,1); 
pump(1).imp(3).H = impellar_data_40160_150(:,2);

pump(1).imp(4).D = 160;
pump(1).imp(4).Q = impellar_data_40160_160(:,1); 
pump(1).imp(4).H = impellar_data_40160_160(:,2);

pump(1).imp(5).D = 169;
pump(1).imp(5).Q = impellar_data_40160_169(:,1); 
pump(1).imp(5).H = impellar_data_40160_169(:,2);

pump(1).eff(1).eta = 45;
pump(1).eff(1).branch(1).Q = efficiency_data_40160_45(:,1);
pump(1).eff(1).branch(1).H = efficiency_data_40160_45(:,2);

pump(1).eff(2).eta = 50;
pump(1).eff(2).branch(1).Q = efficiency_data_40160_50(:,1);
pump(1).eff(2).branch(1).H = efficiency_data_40160_50(:,2);

pump(1).eff(3).eta = 55;
pump(1).eff(3).branch(1).Q = efficiency_data_40160_55_left(:,1);
pump(1).eff(3).branch(1).H = efficiency_data_40160_55_left(:,2);
pump(1).eff(3).branch(2).Q = efficiency_data_40160_55_right(:,1);
pump(1).eff(3).branch(2).H = efficiency_data_40160_55_right(:,2);

pump(1).eff(4).eta = 60;
pump(1).eff(4).branch(1).Q = efficiency_data_40160_60(:,1);
pump(1).eff(4).branch(1).H = efficiency_data_40160_60(:,2);

pump(1).eff(5).eta = 64;
pump(1).eff(5).branch(1).Q = efficiency_data_40160_64(:,1);
pump(1).eff(5).branch(1).H = efficiency_data_40160_64(:,2);

pump(1).eff(6).eta = 66;
pump(1).eff(6).branch(1).Q = efficiency_data_40160_66(:,1);
pump(1).eff(6).branch(1).H = efficiency_data_40160_66(:,2);

pump(1).eff(7).eta = 67.5;
pump(1).eff(7).branch(1).Q = efficiency_data_40160_675(:,1);
pump(1).eff(7).branch(1).H = efficiency_data_40160_675(:,2);


pump(1).Power(1).impsize = 130;
pump(1).Power(1).Q = Power_data_40160_130(:,1);
pump(1).Power(1).P = Power_data_40160_130(:,2);
pump(1).Power(2).impsize = 140;
pump(1).Power(2).Q = Power_data_40160_140(:,1);
pump(1).Power(2).P = Power_data_40160_140(:,2);

pump(1).Power(3).impsize = 150;
pump(1).Power(3).Q = Power_data_40160_150(:,1);
pump(1).Power(3).P = Power_data_40160_150(:,2);

pump(1).Power(4).impsize = 160;
pump(1).Power(4).Q = Power_data_40160_160(:,1);
pump(1).Power(4).P = Power_data_40160_160(:,2);

pump(1).Power(5).impsize = 169;
pump(1).Power(5).Q = Power_data_40160_169(:,1);
pump(1).Power(5).P = Power_data_40160_169(:,2);

% 32160 -------------------------------------------------------------------

pump(2).name = '32160';
pump(2).Q = Q_32160;
pump(2).H = H_32160;
pump(2).imp(1).D = 130;
pump(2).imp(1).Q = impellar_data_32160_130(:,1); 
pump(2).imp(1).H = impellar_data_32160_130(:,2);  

pump(2).imp(2).D = 140;
pump(2).imp(2).Q = impellar_data_32160_140(:,1); 
pump(2).imp(2).H = impellar_data_32160_140(:,2);

pump(2).imp(3).D = 150;
pump(2).imp(3).Q = impellar_data_32160_150(:,1); 
pump(2).imp(3).H = impellar_data_32160_150(:,2);

pump(2).imp(4).D = 160;
pump(2).imp(4).Q = impellar_data_32160_160(:,1); 
pump(2).imp(4).H = impellar_data_32160_160(:,2);

pump(2).imp(5).D = 169;
pump(2).imp(5).Q = impellar_data_32160_169(:,1); 
pump(2).imp(5).H = impellar_data_32160_169(:,2);

pump(2).eff(1).eta = 45;
pump(2).eff(1).branch(1).Q = efficiency_data_32160_45_right(:,1);
pump(2).eff(1).branch(1).H = efficiency_data_32160_45_right(:,2);
pump(2).eff(1).branch(2).Q = efficiency_data_32160_45_left(:,1);
pump(2).eff(1).branch(2).H = efficiency_data_32160_45_left(:,2);

pump(2).eff(2).eta = 50;
pump(2).eff(2).branch(1).Q = efficiency_data_32160_50_right(:,1);
pump(2).eff(2).branch(1).H = efficiency_data_32160_50_right(:,2);
pump(2).eff(2).branch(2).Q = efficiency_data_32160_50_left(:,1);
pump(2).eff(2).branch(2).H = efficiency_data_32160_50_left(:,2);

pump(2).eff(3).eta = 55;
pump(2).eff(3).branch(1).Q = efficiency_data_32160_55_left(:,1);
pump(2).eff(3).branch(1).H = efficiency_data_32160_55_left(:,2);
pump(2).eff(3).branch(2).Q = efficiency_data_32160_55_right(:,1);
pump(2).eff(3).branch(2).H = efficiency_data_32160_55_right(:,2);

pump(2).eff(4).eta = 60;
pump(2).eff(4).branch(1).Q = efficiency_data_32160_60(:,1);
pump(2).eff(4).branch(1).H = efficiency_data_32160_60(:,2);

pump(2).eff(5).eta = 62;
pump(2).eff(5).branch(1).Q = efficiency_data_32160_62(:,1);
pump(2).eff(5).branch(1).H = efficiency_data_32160_62(:,2);

pump(2).eff(6).eta = 63.6;
pump(2).eff(6).branch(1).Q = efficiency_data_32160_636(:,1);
pump(2).eff(6).branch(1).H = efficiency_data_32160_636(:,2);

pump(2).Power(1).impsize = 130;
pump(2).Power(1).Q = Power_data_32160_130(:,1);
pump(2).Power(1).P = Power_data_32160_130(:,2);

pump(2).Power(2).impsize = 140;
pump(2).Power(2).Q = Power_data_32160_140(:,1);
pump(2).Power(2).P = Power_data_32160_140(:,2);

pump(2).Power(3).impsize = 150;
pump(2).Power(3).Q = Power_data_32160_150(:,1);
pump(2).Power(3).P = Power_data_32160_150(:,2);

pump(2).Power(4).impsize = 160;
pump(2).Power(4).Q = Power_data_32160_160(:,1);
pump(2).Power(4).P = Power_data_32160_160(:,2);

pump(2).Power(5).impsize = 169;
pump(2).Power(5).Q = Power_data_32160_169(:,1);
pump(2).Power(5).P = Power_data_32160_169(:,2);

% 40125 -------------------------------------------------------------------

pump(3).name = '40125';
pump(3).Q = Q_40125;
pump(3).H = H_40125;
pump(3).imp(1).D = 110;
pump(3).imp(1).Q = impellar_data_40125_110(:,1); 
pump(3).imp(1).H = impellar_data_40125_110(:,2);  
pump(3).imp(2).D = 115;
pump(3).imp(2).Q = impellar_data_40125_115(:,1); 
pump(3).imp(2).H = impellar_data_40125_115(:,2);
pump(3).imp(3).D = 120;
pump(3).imp(3).Q = impellar_data_40125_120(:,1); 
pump(3).imp(3).H = impellar_data_40125_120(:,2);
pump(3).imp(4).D = 125;
pump(3).imp(4).Q = impellar_data_40125_120(:,1); 
pump(3).imp(4).H = impellar_data_40125_120(:,2);
pump(3).imp(5).D = 130;
pump(3).imp(5).Q = impellar_data_40125_130(:,1); 
pump(3).imp(5).H = impellar_data_40125_130(:,2);
pump(3).imp(6).D = 139;
pump(3).imp(6).Q = impellar_data_40125_139(:,1); 
pump(3).imp(6).H = impellar_data_40125_139(:,2);

pump(3).eff(1).eta = 50;
pump(3).eff(1).branch(1).Q = efficiency_data_40125_50_left(:,1);
pump(3).eff(1).branch(1).H = efficiency_data_40125_50_left(:,2);
pump(3).eff(1).branch(2).Q = efficiency_data_40125_50_right(:,1);
pump(3).eff(1).branch(2).H = efficiency_data_40125_50_right(:,2);

pump(3).eff(2).eta = 55;
pump(3).eff(2).branch(1).Q = efficiency_data_40125_55_left(:,1);
pump(3).eff(2).branch(1).H = efficiency_data_40125_55_left(:,2);
pump(3).eff(2).branch(2).Q = efficiency_data_40125_55_right(:,1);
pump(3).eff(2).branch(2).H = efficiency_data_40125_55_right(:,2);

pump(3).eff(3).eta = 60;
pump(3).eff(3).branch(1).Q = efficiency_data_40125_60_left(:,1);
pump(3).eff(3).branch(1).H = efficiency_data_40125_60_left(:,2);
pump(3).eff(3).branch(2).Q = efficiency_data_40125_60_right(:,1);
pump(3).eff(3).branch(2).H = efficiency_data_40125_60_right(:,2);

pump(3).eff(4).eta = 65;
pump(3).eff(4).branch(1).Q = efficiency_data_40125_65_left(:,1);
pump(3).eff(4).branch(1).H = efficiency_data_40125_65_left(:,2);
pump(3).eff(4).branch(2).Q = efficiency_data_40125_65_right(:,1);
pump(3).eff(4).branch(2).H = efficiency_data_40125_65_right(:,2);

pump(3).eff(5).eta = 68;
pump(3).eff(5).branch(1).Q = efficiency_data_40125_68(:,1);
pump(3).eff(5).branch(1).H = efficiency_data_40125_68(:,2);

pump(3).eff(6).eta = 70;
pump(3).eff(6).branch(1).Q = efficiency_data_40125_70(:,1);
pump(3).eff(6).branch(1).H = efficiency_data_40125_70(:,2);



pump(3).Power(1).impsize = 110;
pump(3).Power(1).Q = Power_data_40125_110(:,1);
pump(3).Power(1).P = Power_data_40125_110(:,2);

pump(3).Power(2).impsize = 115;
pump(3).Power(2).Q = Power_data_40125_115(:,1);
pump(3).Power(2).P = Power_data_40125_115(:,2);

pump(3).Power(3).impsize = 120;
pump(3).Power(3).Q = Power_data_40125_115(:,1);
pump(3).Power(3).P = Power_data_40125_115(:,2);

pump(3).Power(4).impsize = 125;
pump(3).Power(4).Q = Power_data_40125_125(:,1);
pump(3).Power(4).P = Power_data_40125_125(:,2);

pump(3).Power(5).impsize = 130;
pump(3).Power(5).Q = Power_data_40125_130(:,1);
pump(3).Power(5).P = Power_data_40125_130(:,2);

pump(3).Power(6).impsize = 135;
pump(3).Power(6).Q = Power_data_40125_135(:,1);
pump(3).Power(6).P = Power_data_40125_135(:,2);

pump(3).Power(7).impsize = 139;
pump(3).Power(7).Q = Power_data_40125_139(:,1);
pump(3).Power(7).P = Power_data_40125_139(:,2);
% 32125 -------------------------------------------------------------------


pump(4).name = '32125';
pump(4).Q = Q_32125;
pump(4).H = H_32125;
pump(4).imp(1).D = 110;
pump(4).imp(1).Q = impellar_data_32125_110(:,1); 
pump(4).imp(1).H = impellar_data_32125_110(:,2);  
pump(4).imp(2).D = 115;
pump(4).imp(2).Q = impellar_data_32125_115(:,1); 
pump(4).imp(2).H = impellar_data_32125_115(:,2);
pump(4).imp(3).D = 120;
pump(4).imp(3).Q = impellar_data_32125_120(:,1); 
pump(4).imp(3).H = impellar_data_32125_120(:,2);
pump(4).imp(4).D = 125;
pump(4).imp(4).Q = impellar_data_32125_120(:,1); 
pump(4).imp(4).H = impellar_data_32125_120(:,2);
pump(4).imp(5).D = 130;
pump(4).imp(5).Q = impellar_data_32125_130(:,1); 
pump(4).imp(5).H = impellar_data_32125_130(:,2);
pump(4).imp(6).D = 139;
pump(4).imp(6).Q = impellar_data_32125_139(:,1); 
pump(4).imp(6).H = impellar_data_32125_139(:,2);


pump(4).eff(1).eta = 50;
pump(4).eff(1).branch(1).Q = efficiency_data_32125_50_left(:,1);
pump(4).eff(1).branch(1).H = efficiency_data_32125_50_left(:,2);
pump(4).eff(1).branch(2).Q = efficiency_data_32125_50_right(:,1);
pump(4).eff(1).branch(2).H = efficiency_data_32125_50_right(:,2);

pump(4).eff(2).eta = 55;
pump(4).eff(2).branch(1).Q = efficiency_data_32125_55_left(:,1);
pump(4).eff(2).branch(1).H = efficiency_data_32125_55_left(:,2);
pump(4).eff(2).branch(2).Q = efficiency_data_32125_55_right(:,1);
pump(4).eff(2).branch(2).H = efficiency_data_32125_55_right(:,2);

pump(4).eff(3).eta = 59;
pump(4).eff(3).branch(1).Q = efficiency_data_32125_59_left(:,1);
pump(4).eff(3).branch(1).H = efficiency_data_32125_59_left(:,2);
pump(4).eff(3).branch(2).Q = efficiency_data_32125_59_right(:,1);
pump(4).eff(3).branch(2).H = efficiency_data_32125_59_right(:,2);

pump(4).eff(4).eta = 60;
pump(4).eff(4).branch(1).Q = efficiency_data_32125_60(:,1);
pump(4).eff(4).branch(1).H = efficiency_data_32125_60(:,2);

pump(4).eff(5).eta = 62;
pump(4).eff(5).branch(1).Q = efficiency_data_32125_62(:,1);
pump(4).eff(5).branch(1).H = efficiency_data_32125_62(:,2);

pump(4).eff(6).eta = 63;
pump(4).eff(6).branch(1).Q = efficiency_data_32125_63(:,1);
pump(4).eff(6).branch(1).H = efficiency_data_32125_63(:,2);

pump(4).eff(7).eta = 63.5;
pump(4).eff(7).branch(1).Q = efficiency_data_32125_635(:,1);
pump(4).eff(7).branch(1).H = efficiency_data_32125_635(:,2);


pump(4).Power(1).impsize = 110;
pump(4).Power(1).Q = Power_data_32125_110(:,1);
pump(4).Power(1).P = Power_data_32125_110(:,2);

pump(4).Power(2).impsize = 115;
pump(4).Power(2).Q = Power_data_32125_115(:,1);
pump(4).Power(2).P = Power_data_32125_115(:,2);

pump(4).Power(3).impsize = 120;
pump(4).Power(3).Q = Power_data_32125_115(:,1);
pump(4).Power(3).P = Power_data_32125_115(:,2);

pump(4).Power(4).impsize = 125;
pump(4).Power(4).Q = Power_data_32125_125(:,1);
pump(4).Power(4).P = Power_data_32125_125(:,2);

pump(4).Power(5).impsize = 130;
pump(4).Power(5).Q = Power_data_32125_130(:,1);
pump(4).Power(5).P = Power_data_32125_130(:,2);

pump(4).Power(6).impsize = 139;
pump(4).Power(6).Q = Power_data_32125_139(:,1);
pump(4).Power(6).P = Power_data_32125_139(:,2);






%% request data from user -------------------------------------------------
Q_req = input('Enter required flow (m3/h): ');
H_req = input('Enter required head (m):   ');




%%  Pump selection (main curve)

cands = [];

for i = 1:numel(pump)
    if Q_req < min(pump(i).Q) || Q_req > max(pump(i).Q)
        continue
    end
    
    
    H_at_Q = interp1(pump(i).Q, pump(i).H, Q_req, 'linear');
   
    if H_at_Q >= H_req
        cands(end+1).name   = pump(i).name;        
        cands(end)  .Hdeliv = H_at_Q;
        cands(end)  .idx    = i;                   
    end
end

if isempty(cands)
    fprintf('â  No pump meets %.1f m3/h at %.1f m\n', Q_req, H_req);
    return
end


excess = [cands.Hdeliv] - H_req;
[~, bestIdx] = min(excess);

best   = cands(bestIdx);   
pIdx   = best.idx;         

fprintf('â  Selected pump: %s\n', best.name);


%%  Impeller diameter selection for chosen pump

bestImp   = [];          
minExcess = inf;        
imp = pump(pIdx).imp;    
for k = 1:numel(imp)
    if Q_req < min(imp(k).Q) || Q_req > max(imp(k).Q)
        continue
    end
    H_at_Q = interp1(imp(k).Q, imp(k).H, Q_req, 'linear');
    
    if H_at_Q >= H_req            
        excess = H_at_Q - H_req;  
        
        if excess < minExcess    
            minExcess      = excess;
            bestImp.D      = imp(k).D;   
            bestImp.Hdeliv = H_at_Q;    
            bestImp.excessH= excess;
        end
    end
end

if isempty(bestImp)
    fprintf('\nâ  No impeller for pump %s meets head at this flow.\n', best.name);
else
    fprintf('\nð¸  Selected impeller diameter: %d mm\n', bestImp.D);
end


% _________________________________________________________________________

%%  Efficiency estimate at duty point (curveâwise)
% _________________________________________________________________________
eta_list  = [];      
H_list    = [];      
effCurves = pump(pIdx).eff;
for j = 1:numel(effCurves)
    eta_j = effCurves(j).eta;       
    Hcand = [];                      
    for b = 1:numel(effCurves(j).branch)
        Qdat = effCurves(j).branch(b).Q;
        Hdat = effCurves(j).branch(b).H;

        if numel(Qdat) ~= numel(Hdat),  continue, end
        if Q_req < min(Qdat) || Q_req > max(Qdat),  continue, end

        if numel(Qdat) == 1
            Hcand(end+1) = Hdat;         
        else
            Hcand(end+1) = interp1(Qdat, Hdat, Q_req, 'linear');
        end
    end

    if ~isempty(Hcand) 
        [~,ii] = min(abs(Hcand - H_req));
        eta_list(end+1) = eta_j;       
        H_list  (end+1) = Hcand(ii);      
    end
end

if isempty(eta_list)
    fprintf('\nâ ï¸  No efficiency curves cover Q = %.1f mÂ³/h.\n', Q_req);
    eta_pred = NaN;
else
    idx_below = find(H_list <= H_req);
    idx_above = find(H_list >= H_req);
    if ~isempty(idx_below) && ~isempty(idx_above)
        
        [~,ib] = max(H_list(idx_below));
        i1 = idx_below(ib);
        [~,ia] = min(H_list(idx_above));
        i2 = idx_above(ia);
        if i1 == i2                 
            eta_pred = eta_list(i1);
        else                        
            H1 = H_list(i1);   eta1 = eta_list(i1);
            H2 = H_list(i2);   eta2 = eta_list(i2);
            eta_pred = eta1 + (H_req - H1)/(H2 - H1) * (eta2 - eta1);
        end
    else
        [~,imin] = min(abs(H_list - H_req));
        eta_pred = eta_list(imin);
    end
end

% -------- print result --------------------------------------------
if isnan(eta_pred)
    fprintf('\nâ ï¸  Efficiency could not be determined at this point.\n');
else
    fprintf('\nâ­  Predicted efficiency at duty point: %.1f %%\n', eta_pred);
end


% _________________________________________________________________________
%%  Motor power estimate at duty point
% _________________________________________________________________________
powerCurves = pump(pIdx).Power;

idxPow = find([powerCurves.impsize] == bestImp.D, 1);

if isempty(idxPow)
    [~, idxPow] = min(abs([powerCurves.impsize] - bestImp.D));
    fprintf('\nâ ï¸  Power curve for %d mm impeller not found. Using %d mm instead.\n', ...
            bestImp.D, powerCurves(idxPow).impsize);
end

Qpow = powerCurves(idxPow).Q;
Ppow = powerCurves(idxPow).P;

if Q_req < min(Qpow) || Q_req > max(Qpow)
    fprintf('â ï¸  Flow %.1fâ¯mÂ³/h is outside curve range; extrapolating.\n', Q_req);
    P_motor = interp1(Qpow, Ppow, Q_req, 'linear', 'extrap');
else
    P_motor = interp1(Qpow, Ppow, Q_req, 'linear');
end

fprintf('\nð  Estimated shaft power at %.1f mÂ³/h (impeller %d mm): %.2f kW\n', ...
        Q_req, powerCurves(idxPow).impsize, P_motor);



%%Plots for data check ____________________________________________________

%% Plot 1: Main Pump Curves (H-Q)
figure('Name','Pump Main Curves (H-Q)','NumberTitle','off'); hold on
for i = 1:numel(pump)
    plot(pump(i).Q, pump(i).H, 'DisplayName', pump(i).name, 'LineWidth', 1.5)
end
xlabel('Flow rate Q (mÂ³/h)');
ylabel('Head H (m)');
title('Main Pump Curves');
legend('Location','best');
grid on


%% Plot 2: Efficiency & Impeller Curves (One Subplot Per Pump)
figure('Name','Pump Efficiency and Impeller Curves','NumberTitle','off');
for i = 1:numel(pump)
    subplot(ceil(numel(pump)/2),2,i); hold on

    % Efficiency curves (left/right)
    if isfield(pump(i), 'eff')
        for j = 1:numel(pump(i).eff)
            for b = 1:numel(pump(i).eff(j).branch)
                Qdat = pump(i).eff(j).branch(b).Q;
                Hdat = pump(i).eff(j).branch(b).H;
                if numel(Qdat) == numel(Hdat)
                    plot(Qdat, Hdat, 'g-', 'LineWidth', 1.2);
                end
            end
        end
    end

    % Impeller curves
    if isfield(pump(i), 'imp')
        for k = 1:numel(pump(i).imp)
            plot(pump(i).imp(k).Q, pump(i).imp(k).H, 'b--', 'LineWidth', 1.2);
        end
    end

    title(pump(i).name);
    xlabel('Flow rate Q (mÂ³/h)');
    ylabel('Head H (m)');
    grid on
end

%% Plot 3: Power vs Q for all impeller sizes
figure('Name','Pump Power Curves','NumberTitle','off');

for i = 1:numel(pump)
    subplot(ceil(numel(pump)/2),2,i); hold on

    if isfield(pump(i), 'Power')
        for p = 1:numel(pump(i).Power)
            Qdat = pump(i).Power(p).Q;
            Pdat = pump(i).Power(p).P;
            if numel(Qdat) == numel(Pdat)
                plot(Qdat, Pdat, 'r-', 'LineWidth', 1.2, ...
                    'DisplayName', sprintf('%d mm', pump(i).Power(p).impsize));
            end
        end
        legend('Location','best');
    end

    title([pump(i).name ' - Power']);
    xlabel('Flow rate Q (mÂ³/h)');
    ylabel('Power (kW)');
    grid on
end




